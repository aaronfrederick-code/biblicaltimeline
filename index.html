import React, { useState, useMemo } from 'react';
import { Calendar, Scroll, Crown, Split, Landmark, BookOpen, Cross, ChevronDown, ChevronUp, Info } from 'lucide-react';

const eras = [
  { id: 'patriarchal', name: 'The Patriarchal Age', color: 'bg-amber-600', icon: Calendar, text: 'text-amber-700', border: 'border-amber-600', bgLight: 'bg-amber-50' },
  { id: 'exodus', name: 'Exodus & Conquest', color: 'bg-orange-500', icon: Scroll, text: 'text-orange-600', border: 'border-orange-500', bgLight: 'bg-orange-50' },
  { id: 'united', name: 'United Monarchy', color: 'bg-blue-600', icon: Crown, text: 'text-blue-700', border: 'border-blue-600', bgLight: 'bg-blue-50' },
  { id: 'divided', name: 'Divided Kingdom', color: 'bg-red-500', icon: Split, text: 'text-red-600', border: 'border-red-500', bgLight: 'bg-red-50' },
  { id: 'exile', name: 'Exile & Return', color: 'bg-purple-600', icon: Landmark, text: 'text-purple-700', border: 'border-purple-600', bgLight: 'bg-purple-50' },
  { id: 'intertestamental', name: 'Intertestamental Period', color: 'bg-slate-500', icon: BookOpen, text: 'text-slate-600', border: 'border-slate-500', bgLight: 'bg-slate-50' },
  { id: 'new_testament', name: 'New Testament', color: 'bg-emerald-600', icon: Cross, text: 'text-emerald-700', border: 'border-emerald-600', bgLight: 'bg-emerald-50' },
];

const timelineData = [
  // Patriarchal
  { year: 'c. 2166 BC', title: 'Birth of Abraham', description: 'Born in Ur of the Chaldeans.', era: 'patriarchal' },
  { year: 'c. 2091 BC', title: 'The Call of Abraham', description: 'God calls Abraham to leave Ur for Canaan (Genesis 12).', era: 'patriarchal' },
  { year: 'c. 2066 BC', title: 'Birth of Isaac', description: 'Son of Promise born to Abraham and Sarah.', era: 'patriarchal' },
  { year: 'c. 2006 BC', title: 'Birth of Jacob & Esau', description: 'Isaac\'s twin sons.', era: 'patriarchal' },
  { year: 'c. 1915 BC', title: 'Birth of Joseph', description: 'Jacob\'s favored son.', era: 'patriarchal' },
  { year: 'c. 1876 BC', title: 'Move to Egypt', description: 'Jacob’s family moves to Goshen to escape famine.', era: 'patriarchal' },

  // Exodus
  { year: 'c. 1526 BC', title: 'Birth of Moses', description: 'Born during Pharaoh\'s decree to kill Hebrew infants.', era: 'exodus' },
  { year: 'c. 1446 BC', title: 'The Exodus', description: 'Moses leads Israel out of Egypt. The Law given at Sinai.', era: 'exodus' },
  { year: 'c. 1446–1406 BC', title: 'Wilderness Wanderings', description: '40 years of wandering due to unbelief.', era: 'exodus' },
  { year: 'c. 1406 BC', title: 'Entry into Canaan', description: 'Moses dies; Joshua leads the crossing of the Jordan.', era: 'exodus' },
  { year: 'c. 1375–1050 BC', title: 'Period of the Judges', description: 'Cycles of rebellion and deliverance (Gideon, Samson, Deborah).', era: 'exodus' },

  // United Monarchy
  { year: 'c. 1050 BC', title: 'Saul becomes King', description: 'Samuel anoints Israel\'s first king.', era: 'united' },
  { year: 'c. 1010 BC', title: 'David becomes King', description: 'Unites the tribes and captures Jerusalem.', era: 'united' },
  { year: 'c. 970 BC', title: 'Solomon becomes King', description: 'Renowned for wisdom and wealth.', era: 'united' },
  { year: 'c. 966 BC', title: 'Temple Construction', description: 'Solomon builds the First Temple in Jerusalem.', era: 'united' },

  // Divided Kingdom
  { year: '931 BC', title: 'The Kingdom Divides', description: 'Rehoboam\'s harshness splits the nation into Israel (North) and Judah (South).', era: 'divided' },
  { year: 'c. 875–848 BC', title: 'Elijah & Elisha', description: 'Prophetic ministry primarily in the Northern Kingdom.', era: 'divided' },
  { year: '722 BC', title: 'Fall of Northern Kingdom', description: 'Assyria conquers Samaria; the "Lost Tribes" are deported.', era: 'divided' },

  // Exile & Return
  { year: '605 BC', title: 'First Babylonian Deportation', description: 'Daniel and others taken captive.', era: 'exile' },
  { year: '586 BC', title: 'Fall of Jerusalem', description: 'Nebuchadnezzar destroys the Temple. Major exile begins.', era: 'exile' },
  { year: '539 BC', title: 'Fall of Babylon', description: 'Cyrus the Great of Persia conquers Babylon.', era: 'exile' },
  { year: '538 BC', title: 'Edict of Cyrus', description: 'Jews allowed to return to Jerusalem.', era: 'exile' },
  { year: '516 BC', title: 'Second Temple Completed', description: 'Rebuilt under Zerubbabel.', era: 'exile' },
  { year: 'c. 458–445 BC', title: 'Ezra & Nehemiah', description: 'Restoration of the Law and rebuilding of Jerusalem\'s walls.', era: 'exile' },
  { year: 'c. 430 BC', title: 'Malachi', description: 'The final prophet of the Old Testament.', era: 'exile' },

  // Intertestamental
  { year: '332 BC', title: 'Alexander the Great', description: 'Conquers Palestine; Hellenization begins.', era: 'intertestamental' },
  { year: '167–160 BC', title: 'Maccabean Revolt', description: 'Jewish revolt against Seleucid rule; origin of Hanukkah.', era: 'intertestamental' },
  { year: '63 BC', title: 'Roman Conquest', description: 'Pompey captures Jerusalem.', era: 'intertestamental' },

  // New Testament
  { year: 'c. 6–4 BC', title: 'Birth of Jesus', description: 'Born in Bethlehem.', era: 'new_testament' },
  { year: 'c. AD 26/27', title: 'Ministry Begins', description: 'Jesus baptized by John the Baptist.', era: 'new_testament' },
  { year: 'c. AD 30', title: 'The Passion & Pentecost', description: 'Crucifixion, Resurrection, Ascension, and the birth of the Church.', era: 'new_testament' },
  { year: 'c. AD 34', title: 'Conversion of Saul', description: 'Paul\'s encounter on the road to Damascus.', era: 'new_testament' },
  { year: 'c. AD 46–57', title: 'Paul\'s Missionary Journeys', description: 'Expansion of the Gospel to Gentiles in Asia Minor and Greece.', era: 'new_testament' },
  { year: 'AD 70', title: 'Destruction of Jerusalem', description: 'Romans destroy the Second Temple.', era: 'new_testament' },
  { year: 'c. AD 95', title: 'Revelation Written', description: 'Apostle John writes from exile on Patmos.', era: 'new_testament' },
];

const App = () => {
  const [selectedEra, setSelectedEra] = useState('all');

  const filteredData = useMemo(() => {
    return selectedEra === 'all' 
      ? timelineData 
      : timelineData.filter(item => item.era === selectedEra);
  }, [selectedEra]);

  return (
    <div className="min-h-screen bg-slate-50 font-sans text-slate-900 pb-20">
      {/* Header */}
      <header className="bg-slate-900 text-white py-12 px-4 text-center relative overflow-hidden">
        <div className="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none">
          <div className="absolute top-10 left-10 w-32 h-32 rounded-full bg-amber-500 blur-3xl"></div>
          <div className="absolute bottom-10 right-10 w-40 h-40 rounded-full bg-blue-500 blur-3xl"></div>
        </div>
        <h1 className="text-4xl md:text-5xl font-bold mb-4 tracking-tight relative z-10">Biblical Timeline</h1>
        <p className="text-slate-400 max-w-2xl mx-auto text-lg relative z-10">
          Tracing the narrative from the Patriarchs to the Early Church
        </p>
      </header>

      {/* Controls / Legend */}
      <div className="sticky top-0 z-40 bg-white/95 backdrop-blur-sm border-b border-slate-200 shadow-sm transition-all duration-300">
        <div className="max-w-6xl mx-auto px-4 py-4">
          <div className="flex flex-wrap justify-center gap-2">
            <button
              onClick={() => setSelectedEra('all')}
              className={`px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 border ${
                selectedEra === 'all' 
                  ? 'bg-slate-800 text-white border-slate-800 shadow-md transform scale-105' 
                  : 'bg-white text-slate-600 border-slate-300 hover:bg-slate-100'
              }`}
            >
              All Eras
            </button>
            {eras.map((era) => {
              const Icon = era.icon;
              const isSelected = selectedEra === era.id;
              return (
                <button
                  key={era.id}
                  onClick={() => setSelectedEra(era.id)}
                  className={`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 border ${
                    isSelected
                      ? `${era.color} text-white ${era.border} shadow-md transform scale-105`
                      : `bg-white ${era.text} border-slate-200 hover:bg-slate-50`
                  }`}
                >
                  <Icon size={14} />
                  <span className="hidden md:inline">{era.name}</span>
                </button>
              );
            })}
          </div>
          {/* Mobile Legend Label */}
          <div className="md:hidden text-center mt-2 text-xs text-slate-500 font-medium">
             {selectedEra !== 'all' ? eras.find(e => e.id === selectedEra).name : 'Showing All Eras'}
          </div>
        </div>
      </div>

      {/* Timeline Container */}
      <main className="max-w-4xl mx-auto px-4 py-12 relative">
        
        {/* Central Vertical Line */}
        <div className="absolute left-4 md:left-1/2 top-0 bottom-0 w-0.5 bg-slate-200 transform md:-translate-x-1/2 ml-4 md:ml-0 z-0"></div>

        {/* Timeline Items */}
        <div className="space-y-12">
          {filteredData.map((item, index) => {
            const era = eras.find(e => e.id === item.era);
            const Icon = era.icon;
            const isLeft = index % 2 === 0;

            return (
              <div key={index} className={`relative flex items-center ${isLeft ? 'md:flex-row-reverse' : 'md:flex-row'} flex-row-reverse md:justify-between group`}>
                
                {/* Spacer for Desktop Alignment */}
                <div className="hidden md:block w-5/12"></div>

                {/* Center Node */}
                <div className="absolute left-4 md:left-1/2 transform -translate-x-1/2 md:-translate-x-1/2 flex items-center justify-center z-10 ml-4 md:ml-0">
                  <div className={`w-12 h-12 rounded-full border-4 border-white shadow-lg ${era.color} flex items-center justify-center text-white transition-transform duration-300 group-hover:scale-110`}>
                    <Icon size={20} />
                  </div>
                </div>

                {/* Content Card */}
                <div className={`w-[calc(100%-4rem)] md:w-5/12 ml-auto md:ml-0 pl-8 md:pl-0 ${!isLeft ? 'md:pl-0' : ''}`}>
                  <div className={`
                    bg-white p-6 rounded-xl shadow-sm border-l-4 hover:shadow-md transition-shadow duration-300 relative
                    ${era.border}
                  `}>
                    {/* Arrow for Desktop */}
                    <div className={`
                      hidden md:block absolute top-1/2 -translate-y-1/2 w-0 h-0 border-8 border-transparent
                      ${isLeft ? 'right-[-16px] border-l-white' : 'left-[-16px] border-r-white'}
                    `}></div>

                    <div className="flex items-center gap-2 mb-2">
                      <span className={`text-xs font-bold uppercase tracking-wider px-2 py-1 rounded bg-slate-100 ${era.text}`}>
                        {era.name}
                      </span>
                    </div>
                    
                    <h3 className="text-xl font-bold text-slate-800 mb-1">{item.year}</h3>
                    <h4 className="text-lg font-semibold text-slate-700 mb-2">{item.title}</h4>
                    <p className="text-slate-600 text-sm leading-relaxed">
                      {item.description}
                    </p>
                  </div>
                </div>

              </div>
            );
          })}
        </div>

        {/* Empty State */}
        {filteredData.length === 0 && (
            <div className="text-center py-20">
                <p className="text-slate-500 text-lg">No events found for this filter.</p>
                <button onClick={() => setSelectedEra('all')} className="mt-4 text-blue-600 hover:underline">Reset Filter</button>
            </div>
        )}
      </main>

      {/* Footer */}
      <footer className="text-center py-8 text-slate-400 text-sm border-t border-slate-200 mt-12 bg-white">
        <p>Biblical Timeline Visualization</p>
        <p className="text-xs mt-1">Note: Dates prior to 1000 BC are approximate and based on traditional conservative dating.</p>
      </footer>
    </div>
  );
};

export default App;